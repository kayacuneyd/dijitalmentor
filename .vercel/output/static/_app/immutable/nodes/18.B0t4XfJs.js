import{s as it,n as me,d as c,C as rt,F as ft,m as u,K as Xe,D as he,a as ee,i as q,b as o,y as ce,G as zt,c as _,e as p,p as le,g as v,f as U,h,j as y,t as F,J as Lt,H as Pt,l as nt,q as Ye,k as ot,o as Mt,A as Ut,E as Ft}from"../chunks/scheduler.CnGJxXgf.js";import{S as ut,i as dt,t as Oe,a as Ve,e as lt,g as st,d as At,m as Ot,c as St,b as Ht}from"../chunks/index.C5Mc72ys.js";import{e as Pe}from"../chunks/each.DBy0Q7GD.js";import{a as Bt}from"../chunks/auth.DtjIU7We.js";import{a as He}from"../chunks/api.DNO8aZHP.js";import{g as Gt}from"../chunks/entry.Cp_4P-2J.js";import{p as Rt}from"../chunks/stores.DoRINFvc.js";import{t as Ie}from"../chunks/toast.DvxHYnEI.js";const qt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function _t(r,e,t){const l=r.slice();return l[17]=e[t],l}function Kt(r){let e,t=Pe(r[0]),l=[];for(let s=0;s<t.length;s+=1)l[s]=ht(_t(r,t,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Ye()},l(s){for(let a=0;a<l.length;a+=1)l[a].l(s);e=Ye()},m(s,a){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(s,a);q(s,e,a)},p(s,a){if(a&1){t=Pe(s[0]);let n;for(n=0;n<t.length;n+=1){const f=_t(s,t,n);l[n]?l[n].p(f,a):(l[n]=ht(f),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&c(e),nt(l,s)}}}function Jt(r){let e,t="Dersler yÃ¼kleniyor...";return{c(){e=h("option"),e.textContent=t,this.h()},l(l){e=_(l,"OPTION",{"data-svelte-h":!0}),le(e)!=="svelte-l401nf"&&(e.textContent=t),this.h()},h(){e.__value="",he(e,e.__value)},m(l,s){q(l,e,s)},p:me,d(l){l&&c(e)}}}function ht(r){let e,t=r[17].icon+"",l,s,a=r[17].name+"",n,f;return{c(){e=h("option"),l=F(t),s=y(),n=F(a),this.h()},l(i){e=_(i,"OPTION",{});var d=p(e);l=U(d,t),s=v(d),n=U(d,a),d.forEach(c),this.h()},h(){e.__value=f=r[17].id,he(e,e.__value)},m(i,d){q(i,e,d),o(e,l),o(e,s),o(e,n)},p(i,d){d&1&&t!==(t=i[17].icon+"")&&ee(l,t),d&1&&a!==(a=i[17].name+"")&&ee(n,a),d&1&&f!==(f=i[17].id)&&(e.__value=f,he(e,e.__value))},d(i){i&&c(e)}}}function bt(r){let e,t,l="Adres",s,a,n,f;return{c(){e=h("div"),t=h("label"),t.textContent=l,s=y(),a=h("input"),this.h()},l(i){e=_(i,"DIV",{class:!0});var d=p(e);t=_(d,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),le(t)!=="svelte-m81zyj"&&(t.textContent=l),s=v(d),a=_(d,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),d.forEach(c),this.h()},h(){u(t,"class","block text-sm font-medium text-gray-700 mb-1"),u(t,"for","agreement-address"),u(a,"id","agreement-address"),u(a,"type","text"),u(a,"class","w-full border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-sm"),u(a,"placeholder","Adres veya dernek bilgisi"),u(e,"class","md:col-span-2")},m(i,d){q(i,e,d),o(e,t),o(e,s),o(e,a),he(a,r[1].lesson_address),n||(f=ce(a,"input",r[11]),n=!0)},p(i,d){d&3&&a.value!==i[1].lesson_address&&he(a,i[1].lesson_address)},d(i){i&&c(e),n=!1,f()}}}function Xt(r){let e,t,l='<div><h3 class="text-base font-semibold text-gray-900">Onay Formu OluÅŸtur</h3> <p class="text-sm text-gray-500">Ders detaylarÄ±nÄ± belirleyip Jitsi linki oluÅŸturun.</p></div> <span class="px-3 py-1 rounded-full bg-blue-50 text-blue-700 text-xs font-semibold">Jitsi</span>',s,a,n,f,i="Ders",d,g,b,E,x,T="Lokasyon",j,m,k,I,J,V,N,O,A,$,L,S,K,X,Q,w,C,z="Saatlik Ãœcret (â‚¬)",W,te,Te,ae,se,De="HaftalÄ±k Saat",Ne,be,Ce,Z,G,Be="BaÅŸlangÄ±Ã§ Tarihi",ge,ue,D,P,fe,Le="Notlar",ye,re,Se,pe,ne,xe=r[2]?"GÃ¶nderiliyor...":"Onay Formu GÃ¶nder",je,we,Ae,Me;function Ue(B,M){return B[0].length===0?Jt:Kt}let ke=Ue(r),ve=ke(r),de=!r[3]&&bt(r);return{c(){e=h("div"),t=h("div"),t.innerHTML=l,s=y(),a=h("div"),n=h("div"),f=h("label"),f.textContent=i,d=y(),g=h("select"),ve.c(),b=y(),E=h("div"),x=h("p"),x.textContent=T,j=y(),m=h("div"),k=h("button"),I=F("Ã–ÄŸrenci evi"),V=y(),N=h("button"),O=F("Dernek"),$=y(),L=h("button"),S=F("Online"),X=y(),de&&de.c(),Q=y(),w=h("div"),C=h("label"),C.textContent=z,W=y(),te=h("input"),Te=y(),ae=h("div"),se=h("label"),se.textContent=De,Ne=y(),be=h("input"),Ce=y(),Z=h("div"),G=h("label"),G.textContent=Be,ge=y(),ue=h("input"),D=y(),P=h("div"),fe=h("label"),fe.textContent=Le,ye=y(),re=h("textarea"),Se=y(),pe=h("div"),ne=h("button"),je=F(xe),this.h()},l(B){e=_(B,"DIV",{class:!0});var M=p(e);t=_(M,"DIV",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-1b2wj1f"&&(t.innerHTML=l),s=v(M),a=_(M,"DIV",{class:!0});var Y=p(a);n=_(Y,"DIV",{});var oe=p(n);f=_(oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),le(f)!=="svelte-18bmm1w"&&(f.textContent=i),d=v(oe),g=_(oe,"SELECT",{id:!0,class:!0});var _e=p(g);ve.l(_e),_e.forEach(c),oe.forEach(c),b=v(Y),E=_(Y,"DIV",{});var ie=p(E);x=_(ie,"P",{class:!0,"data-svelte-h":!0}),le(x)!=="svelte-1ihk1jj"&&(x.textContent=T),j=v(ie),m=_(ie,"DIV",{class:!0});var H=p(m);k=_(H,"BUTTON",{type:!0,class:!0});var R=p(k);I=U(R,"Ã–ÄŸrenci evi"),R.forEach(c),V=v(H),N=_(H,"BUTTON",{type:!0,class:!0});var Fe=p(N);O=U(Fe,"Dernek"),Fe.forEach(c),$=v(H),L=_(H,"BUTTON",{type:!0,class:!0});var Ge=p(L);S=U(Ge,"Online"),Ge.forEach(c),H.forEach(c),ie.forEach(c),X=v(Y),de&&de.l(Y),Q=v(Y),w=_(Y,"DIV",{});var Ee=p(w);C=_(Ee,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),le(C)!=="svelte-g9oig6"&&(C.textContent=z),W=v(Ee),te=_(Ee,"INPUT",{id:!0,type:!0,min:!0,step:!0,class:!0}),Ee.forEach(c),Te=v(Y),ae=_(Y,"DIV",{});var Re=p(ae);se=_(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),le(se)!=="svelte-n8q7n0"&&(se.textContent=De),Ne=v(Re),be=_(Re,"INPUT",{id:!0,type:!0,min:!0,class:!0}),Re.forEach(c),Ce=v(Y),Z=_(Y,"DIV",{});var qe=p(Z);G=_(qe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),le(G)!=="svelte-1l8jkkb"&&(G.textContent=Be),ge=v(qe),ue=_(qe,"INPUT",{id:!0,type:!0,class:!0}),qe.forEach(c),D=v(Y),P=_(Y,"DIV",{class:!0});var Ke=p(P);fe=_(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),le(fe)!=="svelte-123pnm5"&&(fe.textContent=Le),ye=v(Ke),re=_(Ke,"TEXTAREA",{id:!0,rows:!0,class:!0,placeholder:!0}),p(re).forEach(c),Ke.forEach(c),Y.forEach(c),Se=v(M),pe=_(M,"DIV",{class:!0});var ze=p(pe);ne=_(ze,"BUTTON",{type:!0,class:!0});var Qe=p(ne);je=U(Qe,xe),Qe.forEach(c),ze.forEach(c),M.forEach(c),this.h()},h(){u(t,"class","flex items-center justify-between"),u(f,"class","block text-sm font-medium text-gray-700 mb-1"),u(f,"for","agreement-subject"),u(g,"id","agreement-subject"),u(g,"class","w-full border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-sm"),r[1].subject_id===void 0&&zt(()=>r[7].call(g)),u(x,"class","block text-sm font-medium text-gray-700 mb-1"),u(k,"type","button"),u(k,"class",J=`border rounded-lg px-3 py-2 text-sm ${r[1].lesson_location==="student_home"?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-200 text-gray-700"}`),u(N,"type","button"),u(N,"class",A=`border rounded-lg px-3 py-2 text-sm ${r[1].lesson_location==="turkish_center"?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-200 text-gray-700"}`),u(L,"type","button"),u(L,"class",K=`border rounded-lg px-3 py-2 text-sm ${r[3]?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-200 text-gray-700"}`),u(m,"class","grid grid-cols-3 gap-2"),u(C,"class","block text-sm font-medium text-gray-700 mb-1"),u(C,"for","agreement-rate"),u(te,"id","agreement-rate"),u(te,"type","number"),u(te,"min","0"),u(te,"step","0.5"),u(te,"class","w-full border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-sm"),u(se,"class","block text-sm font-medium text-gray-700 mb-1"),u(se,"for","agreement-hours"),u(be,"id","agreement-hours"),u(be,"type","number"),u(be,"min","1"),u(be,"class","w-full border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-sm"),u(G,"class","block text-sm font-medium text-gray-700 mb-1"),u(G,"for","agreement-start"),u(ue,"id","agreement-start"),u(ue,"type","date"),u(ue,"class","w-full border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-sm"),u(fe,"class","block text-sm font-medium text-gray-700 mb-1"),u(fe,"for","agreement-notes"),u(re,"id","agreement-notes"),u(re,"rows","3"),u(re,"class","w-full border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 text-sm"),u(re,"placeholder","Ã–rn: Haftada 2 saat online matematik..."),u(P,"class","md:col-span-2"),u(a,"class","grid md:grid-cols-2 gap-3"),u(ne,"type","button"),u(ne,"class","px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition disabled:opacity-50"),ne.disabled=we=r[2]||r[0].length===0,u(pe,"class","flex justify-end gap-2"),u(e,"class","bg-white border border-gray-200 rounded-xl p-4 shadow-sm space-y-4")},m(B,M){q(B,e,M),o(e,t),o(e,s),o(e,a),o(a,n),o(n,f),o(n,d),o(n,g),ve.m(g,null),ft(g,r[1].subject_id,!0),o(a,b),o(a,E),o(E,x),o(E,j),o(E,m),o(m,k),o(k,I),o(m,V),o(m,N),o(N,O),o(m,$),o(m,L),o(L,S),o(a,X),de&&de.m(a,null),o(a,Q),o(a,w),o(w,C),o(w,W),o(w,te),he(te,r[1].hourly_rate),o(a,Te),o(a,ae),o(ae,se),o(ae,Ne),o(ae,be),he(be,r[1].hours_per_week),o(a,Ce),o(a,Z),o(Z,G),o(Z,ge),o(Z,ue),he(ue,r[1].start_date),o(a,D),o(a,P),o(P,fe),o(P,ye),o(P,re),he(re,r[1].notes),o(e,Se),o(e,pe),o(pe,ne),o(ne,je),Ae||(Me=[ce(g,"change",r[7]),ce(k,"click",r[8]),ce(N,"click",r[9]),ce(L,"click",r[10]),ce(te,"input",r[12]),ce(be,"input",r[13]),ce(ue,"input",r[14]),ce(re,"input",r[15]),ce(ne,"click",r[4])],Ae=!0)},p(B,[M]){ke===(ke=Ue(B))&&ve?ve.p(B,M):(ve.d(1),ve=ke(B),ve&&(ve.c(),ve.m(g,null))),M&3&&ft(g,B[1].subject_id),M&3&&J!==(J=`border rounded-lg px-3 py-2 text-sm ${B[1].lesson_location==="student_home"?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-200 text-gray-700"}`)&&u(k,"class",J),M&3&&A!==(A=`border rounded-lg px-3 py-2 text-sm ${B[1].lesson_location==="turkish_center"?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-200 text-gray-700"}`)&&u(N,"class",A),M&8&&K!==(K=`border rounded-lg px-3 py-2 text-sm ${B[3]?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-200 text-gray-700"}`)&&u(L,"class",K),B[3]?de&&(de.d(1),de=null):de?de.p(B,M):(de=bt(B),de.c(),de.m(a,Q)),M&3&&Xe(te.value)!==B[1].hourly_rate&&he(te,B[1].hourly_rate),M&3&&Xe(be.value)!==B[1].hours_per_week&&he(be,B[1].hours_per_week),M&3&&he(ue,B[1].start_date),M&3&&he(re,B[1].notes),M&4&&xe!==(xe=B[2]?"GÃ¶nderiliyor...":"Onay Formu GÃ¶nder")&&ee(je,xe),M&5&&we!==(we=B[2]||B[0].length===0)&&(ne.disabled=we)},i:me,o:me,d(B){B&&c(e),ve.d(),de&&de.d(),Ae=!1,rt(Me)}}}function Yt(r,e,t){var V;let l,{conversationId:s}=e,{recipientId:a}=e,{subjects:n=[]}=e;const f=Lt();let i=!1,d={subject_id:((V=n==null?void 0:n[0])==null?void 0:V.id)||"",lesson_location:"online",lesson_address:"",hourly_rate:25,hours_per_week:1,start_date:"",notes:""};async function g(){var N,O;if(!i){if(!n.length){Ie.error("Ders listesi yÃ¼klenemedi");return}if(!d.subject_id||!d.hourly_rate){Ie.error("Ders ve Ã¼cret alanlarÄ± zorunludur");return}if(!l&&!d.lesson_address.trim()){Ie.error("Fiziksel dersler iÃ§in adres girin");return}t(2,i=!0);try{const A={conversation_id:s,recipient_id:a,subject_id:Number(d.subject_id),lesson_location:d.lesson_location,hourly_rate:Number(d.hourly_rate),hours_per_week:Number(d.hours_per_week)||1,start_date:d.start_date||null,notes:((N=d.notes)==null?void 0:N.trim())||null,lesson_address:((O=d.lesson_address)==null?void 0:O.trim())||null,meeting_platform:"jitsi"},$=await He.post("/agreements/create.php",A);Ie.success($.message||"Onay formu gÃ¶nderildi"),f("success",$.data)}catch(A){console.error(A),Ie.error(A.message||"Onay formu oluÅŸturulamadÄ±")}finally{t(2,i=!1)}}}function b(){d.subject_id=Pt(this),t(1,d),t(0,n),t(0,n)}const E=()=>t(1,d.lesson_location="student_home",d),x=()=>t(1,d.lesson_location="turkish_center",d),T=()=>t(1,d.lesson_location="online",d);function j(){d.lesson_address=this.value,t(1,d),t(0,n),t(0,n)}function m(){d.hourly_rate=Xe(this.value),t(1,d),t(0,n),t(0,n)}function k(){d.hours_per_week=Xe(this.value),t(1,d),t(0,n),t(0,n)}function I(){d.start_date=this.value,t(1,d),t(0,n),t(0,n)}function J(){d.notes=this.value,t(1,d),t(0,n),t(0,n)}return r.$$set=N=>{"conversationId"in N&&t(5,s=N.conversationId),"recipientId"in N&&t(6,a=N.recipientId),"subjects"in N&&t(0,n=N.subjects)},r.$$.update=()=>{r.$$.dirty&3&&n.length&&!d.subject_id&&t(1,d.subject_id=n[0].id,d),r.$$.dirty&2&&t(3,l=d.lesson_location==="online")},[n,d,i,l,g,s,a,b,E,x,T,j,m,k,I,J]}class Qt extends ut{constructor(e){super(),dt(this,e,Yt,Xt,it,{conversationId:5,recipientId:6,subjects:0})}}function pt(r){let e,t,l="Adres:",s,a=r[0].lesson_address+"",n;return{c(){e=h("div"),t=h("span"),t.textContent=l,s=y(),n=F(a),this.h()},l(f){e=_(f,"DIV",{class:!0});var i=p(e);t=_(i,"SPAN",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-1zcyz9"&&(t.textContent=l),s=v(i),n=U(i,a),i.forEach(c),this.h()},h(){u(t,"class","font-semibold"),u(e,"class","text-sm text-gray-700")},m(f,i){q(f,e,i),o(e,t),o(e,s),o(e,n)},p(f,i){i&1&&a!==(a=f[0].lesson_address+"")&&ee(n,a)},d(f){f&&c(e)}}}function mt(r){let e,t,l="Not:",s,a=r[0].notes+"",n;return{c(){e=h("div"),t=h("span"),t.textContent=l,s=y(),n=F(a),this.h()},l(f){e=_(f,"DIV",{class:!0});var i=p(e);t=_(i,"SPAN",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-18nsadl"&&(t.textContent=l),s=v(i),n=U(i,a),i.forEach(c),this.h()},h(){u(t,"class","font-semibold"),u(e,"class","text-sm text-gray-700")},m(f,i){q(f,e,i),o(e,t),o(e,s),o(e,n)},p(f,i){i&1&&a!==(a=f[0].notes+"")&&ee(n,a)},d(f){f&&c(e)}}}function gt(r){let e,t,l="Jitsi Linki hazÄ±r",s,a,n,f;return{c(){e=h("div"),t=h("div"),t.textContent=l,s=y(),a=h("a"),n=F("Dersi baÅŸlat"),this.h()},l(i){e=_(i,"DIV",{class:!0});var d=p(e);t=_(d,"DIV",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-yi5prv"&&(t.textContent=l),s=v(d),a=_(d,"A",{class:!0,href:!0,target:!0,rel:!0});var g=p(a);n=U(g,"Dersi baÅŸlat"),g.forEach(c),d.forEach(c),this.h()},h(){u(t,"class","text-sm text-blue-800 font-semibold"),u(a,"class","text-sm font-semibold text-blue-700 underline"),u(a,"href",f=r[0].meeting_link),u(a,"target","_blank"),u(a,"rel","noreferrer"),u(e,"class","flex items-center justify-between gap-3 bg-blue-50 border border-blue-100 rounded-lg px-3 py-2")},m(i,d){q(i,e,d),o(e,t),o(e,s),o(e,a),o(a,n)},p(i,d){d&1&&f!==(f=i[0].meeting_link)&&u(a,"href",f)},d(i){i&&c(e)}}}function vt(r){let e,t,l,s,a,n,f;return{c(){e=h("button"),t=F("Kabul Et"),l=y(),s=h("button"),a=F("Reddet"),this.h()},l(i){e=_(i,"BUTTON",{class:!0});var d=p(e);t=U(d,"Kabul Et"),d.forEach(c),l=v(i),s=_(i,"BUTTON",{class:!0});var g=p(s);a=U(g,"Reddet"),g.forEach(c),this.h()},h(){u(e,"class","px-3 py-2 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition disabled:opacity-50"),e.disabled=r[1],u(s,"class","px-3 py-2 bg-red-600 text-white rounded-lg text-sm font-semibold hover:bg-red-700 transition disabled:opacity-50"),s.disabled=r[1]},m(i,d){q(i,e,d),o(e,t),q(i,l,d),q(i,s,d),o(s,a),n||(f=[ce(e,"click",r[16]),ce(s,"click",r[17])],n=!0)},p(i,d){d&2&&(e.disabled=i[1]),d&2&&(s.disabled=i[1])},d(i){i&&(c(e),c(l),c(s)),n=!1,rt(f)}}}function yt(r){let e,t,l,s;return{c(){e=h("button"),t=F("Ä°ptal Et"),this.h()},l(a){e=_(a,"BUTTON",{class:!0});var n=p(e);t=U(n,"Ä°ptal Et"),n.forEach(c),this.h()},h(){u(e,"class","px-3 py-2 bg-gray-100 text-gray-800 rounded-lg text-sm font-semibold hover:bg-gray-200 transition disabled:opacity-50"),e.disabled=r[1]},m(a,n){q(a,e,n),o(e,t),l||(s=ce(e,"click",r[18]),l=!0)},p(a,n){n&2&&(e.disabled=a[1])},d(a){a&&c(e),l=!1,s()}}}function kt(r){let e,t,l="Ders Saati Kaydet (Ã–dÃ¼l takibi)",s,a,n,f,i,d,g,b,E=r[2]?"Kaydediliyor...":"Saat Ekle",x,T,j;return{c(){e=h("div"),t=h("div"),t.textContent=l,s=y(),a=h("div"),n=h("input"),f=y(),i=h("input"),d=y(),g=h("div"),b=h("button"),x=F(E),this.h()},l(m){e=_(m,"DIV",{class:!0});var k=p(e);t=_(k,"DIV",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-1ndlpj0"&&(t.textContent=l),s=v(k),a=_(k,"DIV",{class:!0});var I=p(a);n=_(I,"INPUT",{type:!0,min:!0,step:!0,placeholder:!0,class:!0}),f=v(I),i=_(I,"INPUT",{type:!0,placeholder:!0,class:!0}),I.forEach(c),d=v(k),g=_(k,"DIV",{class:!0});var J=p(g);b=_(J,"BUTTON",{class:!0});var V=p(b);x=U(V,E),V.forEach(c),J.forEach(c),k.forEach(c),this.h()},h(){u(t,"class","text-sm font-semibold text-gray-900"),u(n,"type","number"),u(n,"min","0.5"),u(n,"step","0.5"),u(n,"placeholder","Saat"),u(n,"class","border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"),u(i,"type","text"),u(i,"placeholder","Not (opsiyonel)"),u(i,"class","border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 md:col-span-2"),u(a,"class","grid md:grid-cols-3 gap-2"),u(b,"class","px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition disabled:opacity-50"),b.disabled=r[2],u(g,"class","flex justify-end"),u(e,"class","border-t border-dashed border-gray-200 pt-3 space-y-2")},m(m,k){q(m,e,k),o(e,t),o(e,s),o(e,a),o(a,n),he(n,r[3]),o(a,f),o(a,i),he(i,r[4]),o(e,d),o(e,g),o(g,b),o(b,x),T||(j=[ce(n,"input",r[19]),ce(i,"input",r[20]),ce(b,"click",r[11])],T=!0)},p(m,k){k&8&&Xe(n.value)!==m[3]&&he(n,m[3]),k&16&&i.value!==m[4]&&he(i,m[4]),k&4&&E!==(E=m[2]?"Kaydediliyor...":"Saat Ekle")&&ee(x,E),k&4&&(b.disabled=m[2])},d(m){m&&c(e),T=!1,rt(j)}}}function Wt(r){let e,t,l,s,a,n,f,i,d,g,b,E="â€¢",x,T,j=(r[9][r[0].lesson_location]||r[0].lesson_location)+"",m,k,I,J,V=r[0].sender_name+"",N,O,A=r[0].recipient_name+"",$,L,S,K=r[0].status+"",X,Q,w,C,z,W,te="Ãœcret",Te,ae,se,De=r[0].hourly_rate+"",Ne,be,Ce,Z,G,Be="HaftalÄ±k",ge,ue,D=r[0].hours_per_week+"",P,fe,Le,ye,re,Se="BaÅŸlangÄ±Ã§",pe,ne,xe=(r[0].start_date||"Belirtilmedi")+"",je,we,Ae,Me,Ue,ke,ve,de,B=r[0].lesson_address&&r[0].lesson_location!=="online"&&pt(r),M=r[0].notes&&mt(r),Y=r[0].meeting_link&&gt(r),oe=r[8]&&vt(r),_e=r[7]&&yt(r),ie=r[0].status==="accepted"&&kt(r);return{c(){e=h("div"),t=h("div"),l=h("div"),s=h("div"),a=h("span"),n=F(r[6]),f=y(),i=h("span"),d=F(r[5]),g=y(),b=h("span"),b.textContent=E,x=y(),T=h("span"),m=F(j),k=y(),I=h("div"),J=F("GÃ¶nderen: "),N=F(V),O=F(" Â· AlÄ±cÄ±: "),$=F(A),L=y(),S=h("span"),X=F(K),w=y(),C=h("div"),z=h("div"),W=h("div"),W.textContent=te,Te=y(),ae=h("div"),se=F("â‚¬"),Ne=F(De),be=F(" / saat"),Ce=y(),Z=h("div"),G=h("div"),G.textContent=Be,ge=y(),ue=h("div"),P=F(D),fe=F(" saat"),Le=y(),ye=h("div"),re=h("div"),re.textContent=Se,pe=y(),ne=h("div"),je=F(xe),we=y(),B&&B.c(),Ae=y(),M&&M.c(),Me=y(),Y&&Y.c(),Ue=y(),ke=h("div"),oe&&oe.c(),ve=y(),_e&&_e.c(),de=y(),ie&&ie.c(),this.h()},l(H){e=_(H,"DIV",{class:!0});var R=p(e);t=_(R,"DIV",{class:!0});var Fe=p(t);l=_(Fe,"DIV",{});var Ge=p(l);s=_(Ge,"DIV",{class:!0});var Ee=p(s);a=_(Ee,"SPAN",{class:!0});var Re=p(a);n=U(Re,r[6]),Re.forEach(c),f=v(Ee),i=_(Ee,"SPAN",{class:!0});var qe=p(i);d=U(qe,r[5]),qe.forEach(c),g=v(Ee),b=_(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),le(b)!=="svelte-9uw2yr"&&(b.textContent=E),x=v(Ee),T=_(Ee,"SPAN",{});var Ke=p(T);m=U(Ke,j),Ke.forEach(c),Ee.forEach(c),k=v(Ge),I=_(Ge,"DIV",{class:!0});var ze=p(I);J=U(ze,"GÃ¶nderen: "),N=U(ze,V),O=U(ze," Â· AlÄ±cÄ±: "),$=U(ze,A),ze.forEach(c),Ge.forEach(c),L=v(Fe),S=_(Fe,"SPAN",{class:!0});var Qe=p(S);X=U(Qe,K),Qe.forEach(c),Fe.forEach(c),w=v(R),C=_(R,"DIV",{class:!0});var Je=p(C);z=_(Je,"DIV",{class:!0});var We=p(z);W=_(We,"DIV",{class:!0,"data-svelte-h":!0}),le(W)!=="svelte-7k5vcf"&&(W.textContent=te),Te=v(We),ae=_(We,"DIV",{class:!0});var Ze=p(ae);se=U(Ze,"â‚¬"),Ne=U(Ze,De),be=U(Ze," / saat"),Ze.forEach(c),We.forEach(c),Ce=v(Je),Z=_(Je,"DIV",{class:!0});var $e=p(Z);G=_($e,"DIV",{class:!0,"data-svelte-h":!0}),le(G)!=="svelte-1qiv4hl"&&(G.textContent=Be),ge=v($e),ue=_($e,"DIV",{class:!0});var at=p(ue);P=U(at,D),fe=U(at," saat"),at.forEach(c),$e.forEach(c),Le=v(Je),ye=_(Je,"DIV",{class:!0});var et=p(ye);re=_(et,"DIV",{class:!0,"data-svelte-h":!0}),le(re)!=="svelte-o77qj9"&&(re.textContent=Se),pe=v(et),ne=_(et,"DIV",{class:!0});var ct=p(ne);je=U(ct,xe),ct.forEach(c),et.forEach(c),Je.forEach(c),we=v(R),B&&B.l(R),Ae=v(R),M&&M.l(R),Me=v(R),Y&&Y.l(R),Ue=v(R),ke=_(R,"DIV",{class:!0});var tt=p(ke);oe&&oe.l(tt),ve=v(tt),_e&&_e.l(tt),tt.forEach(c),de=v(R),ie&&ie.l(R),R.forEach(c),this.h()},h(){u(a,"class","text-lg"),u(i,"class","font-semibold text-gray-900"),u(b,"class","text-gray-400"),u(s,"class","text-sm text-gray-500 flex items-center gap-2"),u(I,"class","text-xs text-gray-500 mt-1"),u(S,"class",Q=`px-3 py-1 rounded-full text-xs font-semibold ${r[0].status==="accepted"?"bg-green-50 text-green-700 border border-green-100":r[0].status==="pending"?"bg-yellow-50 text-yellow-700 border border-yellow-100":"bg-gray-100 text-gray-600 border border-gray-200"}`),u(t,"class","flex items-start justify-between gap-3"),u(W,"class","text-xs text-gray-500"),u(ae,"class","font-semibold"),u(z,"class","p-3 bg-gray-50 rounded-lg border border-gray-100"),u(G,"class","text-xs text-gray-500"),u(ue,"class","font-semibold"),u(Z,"class","p-3 bg-gray-50 rounded-lg border border-gray-100"),u(re,"class","text-xs text-gray-500"),u(ne,"class","font-semibold"),u(ye,"class","p-3 bg-gray-50 rounded-lg border border-gray-100"),u(C,"class","grid md:grid-cols-3 gap-3 text-sm text-gray-700"),u(ke,"class","flex flex-wrap gap-2"),u(e,"class","bg-white border border-gray-200 rounded-xl p-4 shadow-sm space-y-3")},m(H,R){q(H,e,R),o(e,t),o(t,l),o(l,s),o(s,a),o(a,n),o(s,f),o(s,i),o(i,d),o(s,g),o(s,b),o(s,x),o(s,T),o(T,m),o(l,k),o(l,I),o(I,J),o(I,N),o(I,O),o(I,$),o(t,L),o(t,S),o(S,X),o(e,w),o(e,C),o(C,z),o(z,W),o(z,Te),o(z,ae),o(ae,se),o(ae,Ne),o(ae,be),o(C,Ce),o(C,Z),o(Z,G),o(Z,ge),o(Z,ue),o(ue,P),o(ue,fe),o(C,Le),o(C,ye),o(ye,re),o(ye,pe),o(ye,ne),o(ne,je),o(e,we),B&&B.m(e,null),o(e,Ae),M&&M.m(e,null),o(e,Me),Y&&Y.m(e,null),o(e,Ue),o(e,ke),oe&&oe.m(ke,null),o(ke,ve),_e&&_e.m(ke,null),o(e,de),ie&&ie.m(e,null)},p(H,[R]){R&64&&ee(n,H[6]),R&32&&ee(d,H[5]),R&1&&j!==(j=(H[9][H[0].lesson_location]||H[0].lesson_location)+"")&&ee(m,j),R&1&&V!==(V=H[0].sender_name+"")&&ee(N,V),R&1&&A!==(A=H[0].recipient_name+"")&&ee($,A),R&1&&K!==(K=H[0].status+"")&&ee(X,K),R&1&&Q!==(Q=`px-3 py-1 rounded-full text-xs font-semibold ${H[0].status==="accepted"?"bg-green-50 text-green-700 border border-green-100":H[0].status==="pending"?"bg-yellow-50 text-yellow-700 border border-yellow-100":"bg-gray-100 text-gray-600 border border-gray-200"}`)&&u(S,"class",Q),R&1&&De!==(De=H[0].hourly_rate+"")&&ee(Ne,De),R&1&&D!==(D=H[0].hours_per_week+"")&&ee(P,D),R&1&&xe!==(xe=(H[0].start_date||"Belirtilmedi")+"")&&ee(je,xe),H[0].lesson_address&&H[0].lesson_location!=="online"?B?B.p(H,R):(B=pt(H),B.c(),B.m(e,Ae)):B&&(B.d(1),B=null),H[0].notes?M?M.p(H,R):(M=mt(H),M.c(),M.m(e,Me)):M&&(M.d(1),M=null),H[0].meeting_link?Y?Y.p(H,R):(Y=gt(H),Y.c(),Y.m(e,Ue)):Y&&(Y.d(1),Y=null),H[8]?oe?oe.p(H,R):(oe=vt(H),oe.c(),oe.m(ke,ve)):oe&&(oe.d(1),oe=null),H[7]?_e?_e.p(H,R):(_e=yt(H),_e.c(),_e.m(ke,null)):_e&&(_e.d(1),_e=null),H[0].status==="accepted"?ie?ie.p(H,R):(ie=kt(H),ie.c(),ie.m(e,null)):ie&&(ie.d(1),ie=null)},i:me,o:me,d(H){H&&c(e),B&&B.d(),M&&M.d(),Y&&Y.d(),oe&&oe.d(),_e&&_e.d(),ie&&ie.d()}}}function Zt(r,e,t){let l,s,a,n,f,i,d,g;ot(r,Bt,L=>t(15,g=L));let{agreement:b}=e;const E=Lt();let x=!1,T=!1,j="",m="";const k={student_home:"Ã–ÄŸrenci evi",turkish_center:"Dernek",online:"Online"};async function I(L){if(!x){t(1,x=!0);try{await He.post("/agreements/respond.php",{agreement_id:b.id,status:L}),Ie.success(L==="accepted"?"OnaylandÄ±":L==="rejected"?"Reddedildi":"Ä°ptal edildi"),E("responded",{id:b.id,status:L})}catch(S){console.error(S),Ie.error(S.message||"Ä°ÅŸlem baÅŸarÄ±sÄ±z")}finally{t(1,x=!1)}}}async function J(){var S,K,X;if(T)return;const L=parseFloat(j);if(!L||L<=0){Ie.error("GeÃ§erli bir saat deÄŸeri girin");return}t(2,T=!0);try{const Q=await He.post("/rewards/track_hours.php",{agreement_id:b.id,hours_completed:L,notes:(m==null?void 0:m.trim())||null});t(3,j=""),t(4,m="");const w=(K=(S=Q.data)==null?void 0:S.new_rewards)!=null&&K.length?` ðŸŽ‰ ${Q.data.new_rewards.length} Ã¶dÃ¼l kazandÄ±nÄ±z`:"";Ie.success(`Saat kaydedildi. Toplam: ${((X=Q.data)==null?void 0:X.total_hours)||L} saat.${w}`),E("hoursLogged",Q.data)}catch(Q){console.error(Q),Ie.error(Q.message||"Saat kaydedilemedi")}finally{t(2,T=!1)}}const V=()=>I("accepted"),N=()=>I("rejected"),O=()=>I("cancelled");function A(){j=Xe(this.value),t(3,j)}function $(){m=this.value,t(4,m)}return r.$$set=L=>{"agreement"in L&&t(0,b=L.agreement)},r.$$.update=()=>{r.$$.dirty&32768&&t(14,l=g.user),r.$$.dirty&16385&&t(12,s=(l==null?void 0:l.id)===(b==null?void 0:b.sender_id)),r.$$.dirty&16385&&t(13,a=(l==null?void 0:l.id)===(b==null?void 0:b.recipient_id)),r.$$.dirty&8193&&t(8,n=(b==null?void 0:b.status)==="pending"&&a),r.$$.dirty&12289&&t(7,f=(b==null?void 0:b.status)==="pending"&&(a||s)),r.$$.dirty&1&&t(6,i=(b==null?void 0:b.subject_icon)||"ðŸ“˜"),r.$$.dirty&1&&t(5,d=(b==null?void 0:b.subject_name)||"Ders")},[b,x,T,j,m,d,i,f,n,k,I,J,s,a,l,g,V,N,O,A,$]}class $t extends ut{constructor(e){super(),dt(this,e,Zt,Wt,it,{agreement:0})}}const{document:xt}=qt;function wt(r,e,t){const l=r.slice();return l[28]=e[t],l}function Et(r,e,t){const l=r.slice();return l[31]=e[t],l}function It(r,e,t){const l=r.slice();return l[34]=e[t],l}function el(r){let e,t=Pe(r[0]),l=[];for(let s=0;s<t.length;s+=1)l[s]=jt(It(r,t,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Ye()},l(s){for(let a=0;a<l.length;a+=1)l[a].l(s);e=Ye()},m(s,a){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(s,a);q(s,e,a)},p(s,a){if(a[0]&1027){t=Pe(s[0]);let n;for(n=0;n<t.length;n+=1){const f=It(s,t,n);l[n]?l[n].p(f,a):(l[n]=jt(f),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&c(e),nt(l,s)}}}function tl(r){let e,t="HenÃ¼z mesajÄ±nÄ±z yok.";return{c(){e=h("div"),e.textContent=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-18addqo"&&(e.textContent=t),this.h()},h(){u(e,"class","p-4 text-center text-gray-500")},m(l,s){q(l,e,s)},p:me,d(l){l&&c(e)}}}function ll(r){let e,t="YÃ¼kleniyor...";return{c(){e=h("div"),e.textContent=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-oktz64"&&(e.textContent=t),this.h()},h(){u(e,"class","p-4 text-center text-gray-500")},m(l,s){q(l,e,s)},p:me,d(l){l&&c(e)}}}function Dt(r){let e,t=new Date(r[34].last_message_at).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})+"",l;return{c(){e=h("span"),l=F(t),this.h()},l(s){e=_(s,"SPAN",{class:!0});var a=p(e);l=U(a,t),a.forEach(c),this.h()},h(){u(e,"class","text-xs text-gray-400 whitespace-nowrap ml-2")},m(s,a){q(s,e,a),o(e,l)},p(s,a){a[0]&1&&t!==(t=new Date(s[34].last_message_at).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})+"")&&ee(l,t)},d(s){s&&c(e)}}}function Ct(r){let e,t=r[34].unread_count+"",l;return{c(){e=h("div"),l=F(t),this.h()},l(s){e=_(s,"DIV",{class:!0});var a=p(e);l=U(a,t),a.forEach(c),this.h()},h(){u(e,"class","bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center flex-shrink-0")},m(s,a){q(s,e,a),o(e,l)},p(s,a){a[0]&1&&t!==(t=s[34].unread_count+"")&&ee(l,t)},d(s){s&&c(e)}}}function jt(r){let e,t,l=r[34].other_user.name.charAt(0).toUpperCase()+"",s,a,n,f,i,d=r[34].other_user.name+"",g,b,E,x,T=(r[34].last_message||"HenÃ¼z mesaj yok")+"",j,m,k,I,J,V,N,O=r[34].last_message_at&&Dt(r),A=r[34].unread_count>0&&Ct(r);function $(){return r[16](r[34])}return{c(){e=h("button"),t=h("div"),s=F(l),a=y(),n=h("div"),f=h("div"),i=h("h3"),g=F(d),b=y(),O&&O.c(),E=y(),x=h("p"),j=F(T),k=y(),A&&A.c(),I=y(),this.h()},l(L){e=_(L,"BUTTON",{class:!0});var S=p(e);t=_(S,"DIV",{class:!0});var K=p(t);s=U(K,l),K.forEach(c),a=v(S),n=_(S,"DIV",{class:!0});var X=p(n);f=_(X,"DIV",{class:!0});var Q=p(f);i=_(Q,"H3",{class:!0});var w=p(i);g=U(w,d),w.forEach(c),b=v(Q),O&&O.l(Q),Q.forEach(c),E=v(X),x=_(X,"P",{class:!0});var C=p(x);j=U(C,T),C.forEach(c),X.forEach(c),k=v(S),A&&A.l(S),I=v(S),S.forEach(c),this.h()},h(){var L;u(t,"class","w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg"),u(i,"class","font-semibold text-gray-900 truncate"),u(f,"class","flex justify-between items-baseline mb-1"),u(x,"class",m="text-sm text-gray-500 truncate "+(r[34].unread_count>0?"font-semibold text-gray-900":"")),u(n,"class","flex-1 min-w-0"),u(e,"class",J="w-full p-4 flex items-start gap-3 hover:bg-gray-50 transition text-left border-b border-gray-50 last:border-0 "+(((L=r[1])==null?void 0:L.id)===r[34].id?"bg-blue-50/50":""))},m(L,S){q(L,e,S),o(e,t),o(t,s),o(e,a),o(e,n),o(n,f),o(f,i),o(i,g),o(f,b),O&&O.m(f,null),o(n,E),o(n,x),o(x,j),o(e,k),A&&A.m(e,null),o(e,I),V||(N=ce(e,"click",$),V=!0)},p(L,S){var K;r=L,S[0]&1&&l!==(l=r[34].other_user.name.charAt(0).toUpperCase()+"")&&ee(s,l),S[0]&1&&d!==(d=r[34].other_user.name+"")&&ee(g,d),r[34].last_message_at?O?O.p(r,S):(O=Dt(r),O.c(),O.m(f,null)):O&&(O.d(1),O=null),S[0]&1&&T!==(T=(r[34].last_message||"HenÃ¼z mesaj yok")+"")&&ee(j,T),S[0]&1&&m!==(m="text-sm text-gray-500 truncate "+(r[34].unread_count>0?"font-semibold text-gray-900":""))&&u(x,"class",m),r[34].unread_count>0?A?A.p(r,S):(A=Ct(r),A.c(),A.m(e,I)):A&&(A.d(1),A=null),S[0]&3&&J!==(J="w-full p-4 flex items-start gap-3 hover:bg-gray-50 transition text-left border-b border-gray-50 last:border-0 "+(((K=r[1])==null?void 0:K.id)===r[34].id?"bg-blue-50/50":""))&&u(e,"class",J)},d(L){L&&c(e),O&&O.d(),A&&A.d(),V=!1,N()}}}function sl(r){let e,t='<div class="text-6xl">ðŸ’¬</div> <p>MesajlaÅŸmaya baÅŸlamak iÃ§in bir sohbet seÃ§in.</p>';return{c(){e=h("div"),e.innerHTML=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-3wz7a9"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex-1 flex items-center justify-center text-gray-400 flex-col gap-4")},m(l,s){q(l,e,s)},p:me,i:me,o:me,d(l){l&&c(e)}}}function rl(r){let e,t,l=r[1].other_user.name.charAt(0).toUpperCase()+"",s,a,n,f,i=r[1].other_user.name+"",d,g,b,E=r[1].other_user.role==="student"?"Ã–ÄŸretmen":"Veli",x,T,j,m,k,I,J,V='<h4 class="text-sm font-semibold text-gray-900">Onay FormlarÄ±</h4> <p class="text-xs text-gray-500">Ders detaylarÄ± ve Jitsi linkleri</p>',N,O,A=r[8]?"Formu Gizle":"Onay Formu GÃ¶nder",$,L,S,K,X,Q,w,C,z,W,te,Te,ae,se,De,Ne;function be(D,P){return D[2].length===0?al:nl}let Ce=be(r),Z=Ce(r),G=r[8]&&Tt(r);const Be=[ul,il,ol],ge=[];function ue(D,P){return D[7]?0:D[6].length===0?1:2}return K=ue(r),X=ge[K]=Be[K](r),{c(){e=h("div"),t=h("div"),s=F(l),a=y(),n=h("div"),f=h("h3"),d=F(i),g=y(),b=h("span"),x=F(E),T=y(),j=h("div"),Z.c(),m=y(),k=h("div"),I=h("div"),J=h("div"),J.innerHTML=V,N=y(),O=h("button"),$=F(A),L=y(),G&&G.c(),S=y(),X.c(),Q=y(),w=h("div"),C=h("form"),z=h("input"),W=y(),te=h("button"),Te=F("GÃ¶nder"),this.h()},l(D){e=_(D,"DIV",{class:!0});var P=p(e);t=_(P,"DIV",{class:!0});var fe=p(t);s=U(fe,l),fe.forEach(c),a=v(P),n=_(P,"DIV",{});var Le=p(n);f=_(Le,"H3",{class:!0});var ye=p(f);d=U(ye,i),ye.forEach(c),g=v(Le),b=_(Le,"SPAN",{class:!0});var re=p(b);x=U(re,E),re.forEach(c),Le.forEach(c),P.forEach(c),T=v(D),j=_(D,"DIV",{id:!0,class:!0});var Se=p(j);Z.l(Se),Se.forEach(c),m=v(D),k=_(D,"DIV",{class:!0});var pe=p(k);I=_(pe,"DIV",{class:!0});var ne=p(I);J=_(ne,"DIV",{"data-svelte-h":!0}),le(J)!=="svelte-1z0amde"&&(J.innerHTML=V),N=v(ne),O=_(ne,"BUTTON",{class:!0});var xe=p(O);$=U(xe,A),xe.forEach(c),ne.forEach(c),L=v(pe),G&&G.l(pe),S=v(pe),X.l(pe),pe.forEach(c),Q=v(D),w=_(D,"DIV",{class:!0});var je=p(w);C=_(je,"FORM",{class:!0});var we=p(C);z=_(we,"INPUT",{type:!0,placeholder:!0,class:!0}),W=v(we),te=_(we,"BUTTON",{type:!0,class:!0});var Ae=p(te);Te=U(Ae,"GÃ¶nder"),Ae.forEach(c),we.forEach(c),je.forEach(c),this.h()},h(){u(t,"class","w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold"),u(f,"class","font-bold text-gray-900"),u(b,"class","text-xs text-gray-500"),u(e,"class","p-4 bg-white border-b border-gray-100 flex items-center gap-3"),u(j,"id","chat-container"),u(j,"class","flex-1 overflow-y-auto p-4 space-y-4"),u(O,"class","px-3 py-1.5 text-sm font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition"),u(I,"class","flex items-center justify-between"),u(k,"class","bg-white border-t border-gray-100 px-4 py-3 space-y-3"),u(z,"type","text"),u(z,"placeholder","Bir mesaj yazÄ±n..."),u(z,"class","flex-1 border border-gray-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition"),u(te,"type","submit"),u(te,"class","bg-blue-600 text-white px-6 rounded-xl font-semibold hover:bg-blue-700 transition disabled:opacity-50"),te.disabled=ae=!r[3].trim()||r[5],u(C,"class","flex gap-2"),u(w,"class","p-4 bg-white border-t border-gray-100")},m(D,P){q(D,e,P),o(e,t),o(t,s),o(e,a),o(e,n),o(n,f),o(f,d),o(n,g),o(n,b),o(b,x),q(D,T,P),q(D,j,P),Z.m(j,null),q(D,m,P),q(D,k,P),o(k,I),o(I,J),o(I,N),o(I,O),o(O,$),o(k,L),G&&G.m(k,null),o(k,S),ge[K].m(k,null),q(D,Q,P),q(D,w,P),o(w,C),o(C,z),he(z,r[3]),o(C,W),o(C,te),o(te,Te),se=!0,De||(Ne=[ce(O,"click",r[17]),ce(z,"input",r[18]),ce(C,"submit",Ft(r[11]))],De=!0)},p(D,P){(!se||P[0]&2)&&l!==(l=D[1].other_user.name.charAt(0).toUpperCase()+"")&&ee(s,l),(!se||P[0]&2)&&i!==(i=D[1].other_user.name+"")&&ee(d,i),(!se||P[0]&2)&&E!==(E=D[1].other_user.role==="student"?"Ã–ÄŸretmen":"Veli")&&ee(x,E),Ce===(Ce=be(D))&&Z?Z.p(D,P):(Z.d(1),Z=Ce(D),Z&&(Z.c(),Z.m(j,null))),(!se||P[0]&256)&&A!==(A=D[8]?"Formu Gizle":"Onay Formu GÃ¶nder")&&ee($,A),D[8]?G?(G.p(D,P),P[0]&256&&Ve(G,1)):(G=Tt(D),G.c(),Ve(G,1),G.m(k,S)):G&&(st(),Oe(G,1,1,()=>{G=null}),lt());let fe=K;K=ue(D),K===fe?ge[K].p(D,P):(st(),Oe(ge[fe],1,1,()=>{ge[fe]=null}),lt(),X=ge[K],X?X.p(D,P):(X=ge[K]=Be[K](D),X.c()),Ve(X,1),X.m(k,null)),P[0]&8&&z.value!==D[3]&&he(z,D[3]),(!se||P[0]&40&&ae!==(ae=!D[3].trim()||D[5]))&&(te.disabled=ae)},i(D){se||(Ve(G),Ve(X),se=!0)},o(D){Oe(G),Oe(X),se=!1},d(D){D&&(c(e),c(T),c(j),c(m),c(k),c(Q),c(w)),Z.d(),G&&G.d(),ge[K].d(),De=!1,rt(Ne)}}}function nl(r){let e,t=Pe(r[2]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Vt(Et(r,t,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Ye()},l(s){for(let a=0;a<l.length;a+=1)l[a].l(s);e=Ye()},m(s,a){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(s,a);q(s,e,a)},p(s,a){if(a[0]&4){t=Pe(s[2]);let n;for(n=0;n<t.length;n+=1){const f=Et(s,t,n);l[n]?l[n].p(f,a):(l[n]=Vt(f),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&c(e),nt(l,s)}}}function al(r){let e,t="<p>HenÃ¼z mesaj yok. Ä°lk mesajÄ± gÃ¶nderin!</p>";return{c(){e=h("div"),e.innerHTML=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-i063jt"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex items-center justify-center h-full text-gray-400")},m(l,s){q(l,e,s)},p:me,d(l){l&&c(e)}}}function Vt(r){let e,t,l,s=r[31].message_text+"",a,n,f,i=new Date(r[31].created_at).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})+"",d,g,b,E;return{c(){e=h("div"),t=h("div"),l=h("p"),a=F(s),n=y(),f=h("div"),d=F(i),b=y(),this.h()},l(x){e=_(x,"DIV",{class:!0});var T=p(e);t=_(T,"DIV",{class:!0});var j=p(t);l=_(j,"P",{});var m=p(l);a=U(m,s),m.forEach(c),n=v(j),f=_(j,"DIV",{class:!0});var k=p(f);d=U(k,i),k.forEach(c),j.forEach(c),b=v(T),T.forEach(c),this.h()},h(){u(f,"class","text-xs mt-1 opacity-70 text-right"),u(t,"class",g="max-w-[70%] rounded-2xl px-4 py-2 "+(r[31].is_mine?"bg-blue-600 text-white rounded-br-none":"bg-white border border-gray-100 text-gray-800 rounded-bl-none")),u(e,"class",E="flex "+(r[31].is_mine?"justify-end":"justify-start"))},m(x,T){q(x,e,T),o(e,t),o(t,l),o(l,a),o(t,n),o(t,f),o(f,d),o(e,b)},p(x,T){T[0]&4&&s!==(s=x[31].message_text+"")&&ee(a,s),T[0]&4&&i!==(i=new Date(x[31].created_at).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})+"")&&ee(d,i),T[0]&4&&g!==(g="max-w-[70%] rounded-2xl px-4 py-2 "+(x[31].is_mine?"bg-blue-600 text-white rounded-br-none":"bg-white border border-gray-100 text-gray-800 rounded-bl-none"))&&u(t,"class",g),T[0]&4&&E!==(E="flex "+(x[31].is_mine?"justify-end":"justify-start"))&&u(e,"class",E)},d(x){x&&c(e)}}}function Tt(r){let e,t;return e=new Qt({props:{conversationId:r[1].id,recipientId:r[1].other_user.id,subjects:r[9]}}),e.$on("success",r[12]),{c(){Ht(e.$$.fragment)},l(l){St(e.$$.fragment,l)},m(l,s){Ot(e,l,s),t=!0},p(l,s){const a={};s[0]&2&&(a.conversationId=l[1].id),s[0]&2&&(a.recipientId=l[1].other_user.id),s[0]&512&&(a.subjects=l[9]),e.$set(a)},i(l){t||(Ve(e.$$.fragment,l),t=!0)},o(l){Oe(e.$$.fragment,l),t=!1},d(l){At(e,l)}}}function ol(r){let e,t,l=Pe(r[6]),s=[];for(let n=0;n<l.length;n+=1)s[n]=Nt(wt(r,l,n));const a=n=>Oe(s[n],1,1,()=>{s[n]=null});return{c(){e=h("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=_(n,"DIV",{class:!0});var f=p(e);for(let i=0;i<s.length;i+=1)s[i].l(f);f.forEach(c),this.h()},h(){u(e,"class","grid gap-3")},m(n,f){q(n,e,f);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);t=!0},p(n,f){if(f[0]&24640){l=Pe(n[6]);let i;for(i=0;i<l.length;i+=1){const d=wt(n,l,i);s[i]?(s[i].p(d,f),Ve(s[i],1)):(s[i]=Nt(d),s[i].c(),Ve(s[i],1),s[i].m(e,null))}for(st(),i=l.length;i<s.length;i+=1)a(i);lt()}},i(n){if(!t){for(let f=0;f<l.length;f+=1)Ve(s[f]);t=!0}},o(n){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)Oe(s[f]);t=!1},d(n){n&&c(e),nt(s,n)}}}function il(r){let e,t="HenÃ¼z onay formu yok.";return{c(){e=h("div"),e.textContent=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-1d1jmzq"&&(e.textContent=t),this.h()},h(){u(e,"class","text-sm text-gray-500")},m(l,s){q(l,e,s)},p:me,i:me,o:me,d(l){l&&c(e)}}}function ul(r){let e,t="Onay formlarÄ± yÃ¼kleniyor...";return{c(){e=h("div"),e.textContent=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-18cgl59"&&(e.textContent=t),this.h()},h(){u(e,"class","text-sm text-gray-500")},m(l,s){q(l,e,s)},p:me,i:me,o:me,d(l){l&&c(e)}}}function Nt(r){let e,t;return e=new $t({props:{agreement:r[28]}}),e.$on("responded",r[13]),e.$on("hoursLogged",r[14]),{c(){Ht(e.$$.fragment)},l(l){St(e.$$.fragment,l)},m(l,s){Ot(e,l,s),t=!0},p(l,s){const a={};s[0]&64&&(a.agreement=l[28]),e.$set(a)},i(l){t||(Ve(e.$$.fragment,l),t=!0)},o(l){Oe(e.$$.fragment,l),t=!1},d(l){At(e,l)}}}function dl(r){let e,t,l,s,a,n='<h2 class="text-xl font-bold text-gray-900">Mesajlar</h2>',f,i,d,g,b,E,x;function T(V,N){return V[4]?ll:V[0].length===0?tl:el}let j=T(r),m=j(r);const k=[rl,sl],I=[];function J(V,N){return V[1]?0:1}return b=J(r),E=I[b]=k[b](r),{c(){e=y(),t=h("div"),l=h("div"),s=h("div"),a=h("div"),a.innerHTML=n,f=y(),i=h("div"),m.c(),d=y(),g=h("div"),E.c(),this.h()},l(V){Mt("svelte-1pn4os3",xt.head).forEach(c),e=v(V),t=_(V,"DIV",{class:!0});var O=p(t);l=_(O,"DIV",{class:!0});var A=p(l);s=_(A,"DIV",{class:!0});var $=p(s);a=_($,"DIV",{class:!0,"data-svelte-h":!0}),le(a)!=="svelte-uykqy"&&(a.innerHTML=n),f=v($),i=_($,"DIV",{class:!0});var L=p(i);m.l(L),L.forEach(c),$.forEach(c),d=v(A),g=_(A,"DIV",{class:!0});var S=p(g);E.l(S),S.forEach(c),A.forEach(c),O.forEach(c),this.h()},h(){xt.title="Mesajlar - DijitalMentor",u(a,"class","p-4 border-b border-gray-100"),u(i,"class","flex-1 overflow-y-auto"),u(s,"class","w-full md:w-80 border-r border-gray-100 flex flex-col"),u(g,"class","flex-1 flex flex-col bg-gray-50/30 hidden md:flex"),u(l,"class","bg-white rounded-2xl shadow-sm border border-gray-100 h-full flex overflow-hidden"),u(t,"class","container mx-auto px-4 py-8 h-[calc(100vh-4rem)]")},m(V,N){q(V,e,N),q(V,t,N),o(t,l),o(l,s),o(s,a),o(s,f),o(s,i),m.m(i,null),o(l,d),o(l,g),I[b].m(g,null),x=!0},p(V,N){j===(j=T(V))&&m?m.p(V,N):(m.d(1),m=j(V),m&&(m.c(),m.m(i,null)));let O=b;b=J(V),b===O?I[b].p(V,N):(st(),Oe(I[O],1,1,()=>{I[O]=null}),lt(),E=I[b],E?E.p(V,N):(E=I[b]=k[b](V),E.c()),Ve(E,1),E.m(g,null))},i(V){x||(Ve(E),x=!0)},o(V){Oe(E),x=!1},d(V){V&&(c(e),c(t)),m.d(),I[b].d()}}}function cl(r,e,t){let l,s;ot(r,Bt,w=>t(15,l=w)),ot(r,Rt,w=>t(22,s=w));let a=[],n=null,f=[],i="",d=!0,g=!1,b=[],E=!1,x=!1,T=[],j=!1,m;Ut(async()=>{var C;if(!l.isAuthenticated){Gt("/giris");return}await k();const w=s.url.searchParams.get("teacher_id");if(w){const z=parseInt(w);((C=l.user)==null?void 0:C.role)==="student"?Ie.error("Ã–ÄŸretmenler diÄŸer Ã¶ÄŸretmenlerle mesajlaÅŸamaz"):await O(z)}else a.length>0&&I(a[0]);return V(),m=setInterval(()=>{n&&(J(n.id,!0),N(n.id,!0)),k()},3e4),()=>{m&&clearInterval(m)}});async function k(){try{const w=await He.get("/messages/list.php");t(0,a=w.data)}catch(w){console.error(w)}finally{t(4,d=!1)}}async function I(w){t(1,n=w),await J(w.id),await N(w.id)}async function J(w,C=!1){try{const z=await He.get(`/messages/detail.php?conversation_id=${w}`);t(2,f=z.data.messages.reverse()),setTimeout(()=>{const W=document.getElementById("chat-container");W&&(W.scrollTop=W.scrollHeight)},0)}catch(z){C||console.error(z)}}async function V(){if(!(j||T.length)){j=!0;try{const w=await He.get("/subjects/list.php");t(9,T=w.data||[])}catch(w){console.error(w)}finally{j=!1}}}async function N(w,C=!1){if(w){t(7,E=!0);try{const z=await He.get(`/agreements/list.php?conversation_id=${w}`);t(6,b=z.data||[])}catch(z){C||(console.error(z),Ie.error("Onay formlarÄ± yÃ¼klenemedi"))}finally{t(7,E=!1)}}}async function O(w){try{const C=await He.post("/messages/start.php",{other_user_id:w});await k();const z=a.find(W=>W.id===C.data.conversation_id);z&&I(z)}catch(C){console.error(C),alert("MesajlaÅŸma baÅŸlatÄ±lamadÄ±. LÃ¼tfen tekrar deneyin.")}}async function A(){if(!i.trim()||!n)return;t(5,g=!0);const w=i;t(3,i="");try{const C=await He.post("/messages/send.php",{conversation_id:n.id,message_text:w});t(2,f=[...f,C.data]);const z=a.findIndex(W=>W.id===n.id);if(z!==-1){t(0,a[z].last_message=C.data.message_text,a),t(0,a[z].last_message_at=C.data.created_at,a);const W=a.splice(z,1)[0];t(0,a=[W,...a])}setTimeout(()=>{const W=document.getElementById("chat-container");W&&(W.scrollTop=W.scrollHeight)},0)}catch(C){console.error(C),t(3,i=w),alert("Mesaj gÃ¶nderilemedi. LÃ¼tfen tekrar deneyin.")}finally{t(5,g=!1)}}function $(){t(8,x=!1),n&&N(n.id)}function L(){n&&N(n.id)}function S(w){var z;const C=((z=w.detail)==null?void 0:z.new_rewards)||[];C.length&&Ie.success(`Tebrikler! ${C.length} yeni Ã¶dÃ¼l aÃ§Ä±ldÄ±.`)}const K=w=>I(w),X=()=>t(8,x=!x);function Q(){i=this.value,t(3,i)}return r.$$.update=()=>{r.$$.dirty[0]&32768&&l.user},[a,n,f,i,d,g,b,E,x,T,I,A,$,L,S,l,K,X,Q]}class yl extends ut{constructor(e){super(),dt(this,e,cl,dl,it,{},null,[-1,-1])}}export{yl as component};
